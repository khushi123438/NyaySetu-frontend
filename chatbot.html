<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legal Assistant Chatbot</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .demo-content {
            text-align: center;
            color: white;
            padding: 2rem;
        }

        .demo-content h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .demo-content p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* Chatbot Styles */
        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .chat-bubble {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            font-size: 24px;
        }

        .chat-bubble:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 25px rgba(0,0,0,0.2);
        }

        .chat-window {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-end;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message.bot {
            justify-content: flex-start;
        }

        .message-content {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message.bot .message-content {
            background: white;
            color: #333;
            border: 1px solid #e0e0e0;
            border-bottom-left-radius: 4px;
        }

        .chat-input-container {
            padding: 15px 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #667eea;
        }

        .send-button {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .send-button:hover {
            transform: scale(1.1);
        }

        .send-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .typing-indicator {
            display: none;
            padding: 12px 16px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            margin-bottom: 15px;
            color: #666;
            font-style: italic;
        }

        .close-button {
            margin-left: auto;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 18px;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .close-button:hover {
            background: rgba(255,255,255,0.2);
        }

        /* Scrollbar styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Responsive design */
        @media (max-width: 480px) {
            .chat-window {
                width: calc(100vw - 40px);
                right: -10px;
            }
            
            .chat-bubble {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Demo content for testing -->
    <div class="demo-content">
        <h1>Legal Assistant Chatbot</h1>
        <p>Click the chat bubble in the bottom-right corner to start chatting!</p>
    </div>

    <!-- Chatbot Container -->
    <div class="chatbot-container">
        <!-- Chat Bubble -->
        <div class="chat-bubble" onclick="toggleChat()">
            üí¨
        </div>

        <!-- Chat Window -->
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                ‚öñÔ∏è Legal Assistant
                <button class="close-button" onclick="toggleChat()">√ó</button>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    <div class="message-content">
                        Hello! I'm your legal assistant. I can help you understand the required documents for different case types like Divorce, Property, Criminal, Business Registration, Civil cases, and more. How can I assist you today?
                    </div>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                Assistant is typing...
            </div>

            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)">
                <button class="send-button" onclick="sendMessage()" id="sendButton">
                    ‚û§
                </button>
            </div>
        </div>
    </div>

    <script>
        // REPLACE 'YOUR_GEMINI_API_KEY' WITH YOUR ACTUAL GEMINI API KEY
        const GEMINI_API_KEY = 'AIzaSyAJ10VHnlQOj4rX0wQKn6byr2WqFZag2EY';
        const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

        // System prompt for the legal assistant
        const SYSTEM_PROMPT = `You are a helpful multilingual legal assistant chatbot for a website that connects people with advocates. Your job is to tell users the general list of required documents for different case types (Divorce, Property, Criminal, Business Registration, Civil, etc.). Always reply in the same language as the user (English, Hindi, or regional languages like Marathi, Tamil, Telugu, Bengali, Gujarati, etc.). Always end with: ‚ö†Ô∏è 'This is only general guidance. Please consult an advocate for your specific case.'`;

        let isChatOpen = false;

        function toggleChat() {
            const chatWindow = document.getElementById('chatWindow');
            isChatOpen = !isChatOpen;
            
            if (isChatOpen) {
                chatWindow.style.display = 'flex';
                document.getElementById('chatInput').focus();
            } else {
                chatWindow.style.display = 'none';
            }
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function addMessage(content, isUser = false) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'bot'}`;
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.textContent = content;
            
            messageDiv.appendChild(messageContent);
            chatMessages.appendChild(messageDiv);
            
            // Scroll to bottom
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const sendButton = document.getElementById('sendButton');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Disable input and button
            input.disabled = true;
            sendButton.disabled = true;
            
            // Add user message
            addMessage(message, true);
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Prepare the request to Gemini API
                const requestBody = {
                    contents: [{
                        parts: [{
                            text: `${SYSTEM_PROMPT}\n\nUser: ${message}\n\nAssistant:`
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 1024,
                    }
                };

                                 console.log('Sending request to:', GEMINI_API_URL);
                 console.log('Request body:', requestBody);
                 
                 const response = await fetch(GEMINI_API_URL, {
                     method: 'POST',
                     headers: {
                         'Content-Type': 'application/json',
                     },
                     body: JSON.stringify(requestBody)
                 });

                 console.log('Response status:', response.status);
                 console.log('Response headers:', response.headers);

                 if (!response.ok) {
                     const errorText = await response.text();
                     console.error('Response error text:', errorText);
                     throw new Error(`HTTP error! status: ${response.status} - ${errorText}`);
                 }

                const data = await response.json();
                
                if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                    const botResponse = data.candidates[0].content.parts[0].text;
                    addMessage(botResponse, false);
                } else {
                    throw new Error('Invalid response format from Gemini API');
                }
                
                         } catch (error) {
                 console.error('Error calling Gemini API:', error);
                 console.error('Error details:', error.message);
                 addMessage(`Error: ${error.message}. Please check your API key and try again.`, false);
             } finally {
                // Re-enable input and button
                input.disabled = false;
                sendButton.disabled = false;
                hideTypingIndicator();
                input.focus();
            }
        }

        // Initialize chatbot
        document.addEventListener('DOMContentLoaded', function() {
            // Check if API key is set
            if (GEMINI_API_KEY === 'YOUR_GEMINI_API_KEY') {
                console.warn('‚ö†Ô∏è Please replace YOUR_GEMINI_API_KEY with your actual Gemini API key in the JavaScript code.');
                addMessage('‚ö†Ô∏è Please configure your Gemini API key to use this chatbot.', false);
            }
        });
    </script>
</body>
</html>
